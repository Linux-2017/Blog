{"title":"centos7.3构建lamp环境","slug":"lamp源码包安装","date":"2017-04-02T04:00:09.000Z","updated":"2017-12-09T13:58:19.000Z","comments":true,"excerpt":"","content":"<h2 id=\"centos7-3构建lamp环境\"><a href=\"#centos7-3构建lamp环境\" class=\"headerlink\" title=\"centos7.3构建lamp环境\"></a>centos7.3构建lamp环境</h2><h3 id=\"apache\"><a href=\"#apache\" class=\"headerlink\" title=\"apache\"></a><strong>apache</strong></h3><ul>\n<li><p>安装httpd依赖包</p>\n<ul>\n<li>yum groupinstall “Development Tools” “Server Platform Development” –y</li>\n<li>yum install pcre-devel –y</li>\n<li>apr-devel  apr-util-devel openssl-devel apr-devel apr-util-devel openssl-devel</li>\n</ul>\n</li>\n<li><p>编译安装</p>\n<p> ./configure –prefix=/usr/local/apache24 –enable-so –enable-ssl  –enable-rewrite –with-zlib –with-pcre –with-apr=/usr –with-apr-util=/usr –enable-modules=most –enable-mpms-shared=all –with-mpm=prefork</p>\n<p>make  -j 2&amp;&amp; make install</p>\n</li>\n</ul>\n<p>  /usr/local/apache24/bin/apachectl start</p>\n<h3 id=\"Maradb\"><a href=\"#Maradb\" class=\"headerlink\" title=\"Maradb\"></a><strong>Maradb</strong></h3><ul>\n<li><p>通用二进制方式安装</p>\n\n    <pre><code class=\"lang-bash\">tar xvf mariadb-5.5.46-linux-x86_64.tar.gz -C <span class=\"hljs-string\">/usr/local/</span>\n<span class=\"hljs-keyword\">cd</span> <span class=\"hljs-string\">/usr/local/</span>\nln -sv mariadb-5.5.46-linux-x86_64/ mysql\ngroupadd -g 27 mysql\nuseradd -u 27 -g mysql mysql\nchown -R root.mysql <span class=\"hljs-string\">/usr/local/mysql/</span>\nmkdir <span class=\"hljs-string\">/mysqldata</span>\nchown -R mysql.mysql <span class=\"hljs-string\">/mysqldata</span>\nmkdir <span class=\"hljs-string\">/etc/mysql</span>\nmv <span class=\"hljs-string\">/etc/my.cnf</span>{,<span class=\"hljs-string\">.bak</span>}\n<span class=\"hljs-keyword\">cd</span> <span class=\"hljs-string\">/usr/local/mysql/support-file</span>\ncp my-large.cnf <span class=\"hljs-string\">/etc/mysql/my.cnf</span>\nvim <span class=\"hljs-string\">/etc/mysql/my.cnf</span>  加入\ndatadir = <span class=\"hljs-string\">/mysqldata</span>\nskip_name_resolve = ON\ninnodb_file_per_table = ON\ncp mysql.server  <span class=\"hljs-string\">/etc/init.d/mysqld</span>\nchkconfig <span class=\"hljs-params\">--add</span> mysqld\n<span class=\"hljs-keyword\">cd</span> <span class=\"hljs-string\">/usr/local/mysql</span>\n<span class=\"hljs-string\">./scripts/mysql_install_db</span> <span class=\"hljs-params\">--user=mysql</span> <span class=\"hljs-params\">--datadir=/mysqldata</span>\n[root@aa mysql]<span class=\"hljs-comment\"># /etc/init.d/mysqld start</span>\nStarting MySQL.. SUCCESS!\n</code></pre>\n</li>\n</ul>\n<h3 id=\"Php5-6-4\"><a href=\"#Php5-6-4\" class=\"headerlink\" title=\"Php5.6.4\"></a><strong>Php5.6.4</strong></h3><ul>\n<li><p>make -j 4 &amp;&amp; make install安装依赖包</p>\n<blockquote>\n<p>yum install libxml2-devel libmcrypt-devel bzip2-devel  curl-devel  libmcypt libmcrypt-devel(epel源)</p>\n</blockquote>\n</li>\n<li><p>编译安装</p>\n<blockquote>\n<p>tar xvf php5.6.4.tar.xz</p>\n<p>./configure –prefix=/usr/local/php –with-mysql=/usr/local/mysql –with-openssl –with-mysqli=/usr/local/mysql/bin/mysql_config –enable-mbstring –with-freetype-dir –with-jpeg-dir –with-png-dir –with-zlib –with-libxml-dir=/usr –enable-xml –enable-sockets –with-apxs2=/usr/local/apache24/bin/apxs –with-mcrypt  –with-config-file-path=/etc –with-config-file-scan-dir=/etc/php.d –with-bz2  –enable-maintainer-zts  –with-curl</p>\n<p>这里为了支持apache的worker或event这两个MPM，编译时使用了–enable-maintainer-zts选项</p>\n<p>make &amp;&amp; make install</p>\n<p>安装完成后在httpd.conf中加入</p>\n<p>AddType application/x-httpd-php .php</p>\n</blockquote>\n\n    <pre><code class=\"lang-bash\">  &lt;IfModule dir_module&gt;\n       DirectoryIndex index<span class=\"hljs-selector-class\">.html</span> index<span class=\"hljs-selector-class\">.php</span>\n   &lt;/IfModule&gt;\n</code></pre>\n<p>​</p>\n<p>​</p>\n</li>\n</ul>\n<blockquote>\n<p>Centos 7 yum一键lamp脚本</p>\n</blockquote>\n\n    <pre><code class=\"lang-bash\"><span class=\"hljs-comment\">#!/bin/bash</span>\n<span class=\"hljs-comment\">#Author:shen</span>\n<span class=\"hljs-comment\">#date:Saturday, April 22, 2017 AM10:21:54 CST</span>\n<span class=\"hljs-comment\">#description: centos 7 lamp</span>\nip=<span class=\"hljs-string\">`ifconfig | sed -n '2p'|awk '{print $2}'`</span>\nyum install httpd php php-fpm php-mysql mariadb-server -y\n\nsystemctl enable httpd    &amp;<span class=\"hljs-meta\">&gt;&gt; </span>/tmp/lamp.log\nsystemctl enable php-fpm  &amp;<span class=\"hljs-meta\">&gt;&gt; </span>/tmp/lamp.log\nsystemctl enable mariadb  &amp;<span class=\"hljs-meta\">&gt;&gt; </span>/tmp/lamp.log\n\nsystemctl start httpd &amp;<span class=\"hljs-meta\">&gt;&gt; </span>/tmp/lamp.log\nsystemctl start php-fpm &amp;<span class=\"hljs-meta\">&gt;&gt; </span>/tmp/lamp.log\nsystemctl start mariadb&amp;<span class=\"hljs-meta\">&gt;&gt; </span>/tmp/lamp.log\n\ntouch /tmp/testdb.txt\ncat &gt; <span class=\"hljs-regexp\">/tmp/testdb</span>.txt &lt;&lt; of\ncreate database shen;\ngrant all privileges on *.* to shen@<span class=\"hljs-string\">'%'</span> identified by <span class=\"hljs-string\">'123456'</span>;\nflush privileges;\nof\n\necho test &gt; <span class=\"hljs-regexp\">/var/www</span><span class=\"hljs-regexp\">/html/index</span>.html\n\ncat &gt; <span class=\"hljs-regexp\">/var/www</span><span class=\"hljs-regexp\">/html/phpinfo</span>.php &lt;&lt; of\n&lt;?php\n\nphpinfo ();\n\n<span class=\"hljs-meta\">?&gt;</span>\nof\n\n\ncat &gt; <span class=\"hljs-regexp\">/var/www</span><span class=\"hljs-regexp\">/html/testdb</span>.php &lt;&lt; of\n&lt;?php\n\n\\$conn = mysql_connect(<span class=\"hljs-string\">'$ip'</span>,<span class=\"hljs-string\">'shen'</span>,<span class=\"hljs-string\">'123456'</span>);\n\n<span class=\"hljs-keyword\">if</span> (\\$conn)\n    echo <span class=\"hljs-string\">\"ok\"</span>;\n<span class=\"hljs-keyword\">else</span>\n    echo <span class=\"hljs-string\">\"not ok\"</span>\n<span class=\"hljs-meta\">?&gt;</span>\nof\n\n\nmysql &lt; <span class=\"hljs-regexp\">/tmp/testdb</span>.txt\n</code></pre>\n","categories":[{"name":"Linux","path":"api/categories/Linux.json"}],"tags":[{"name":"Linux","path":"api/tags/Linux.json"}]}